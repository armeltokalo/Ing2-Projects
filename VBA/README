# ðŸ“Š README â€” Automatisation des rapports de ventes (VBA)

<div style="display:flex;gap:8px;align-items:center;margin-bottom:12px;">
  <div style="background:#0ea5a4;color:white;padding:6px 10px;border-radius:8px;font-weight:700;">VBA â€¢ Excel</div>
  <div style="background:#f59e0b;color:white;padding:6px 10px;border-radius:8px;font-weight:700;">Automatisation</div>
  <div style="background:#6366f1;color:white;padding:6px 10px;border-radius:8px;font-weight:700;">Rapports hebdo & mensuel</div>
</div>

---

## âœ¨ 1. PrÃ©sentation

Ce projet fournit un **outil VBA** pour gÃ©nÃ©rer automatiquement des **rapports de ventes hebdomadaires** et **mensuels** Ã  partir de donnÃ©es brutes dans Excel. L'objectif est de rendre la production des rapports **fiable**, **rÃ©pÃ©table** et **facile Ã  programmer** (ex. via le Planificateur de tÃ¢ches Windows).

> âœ… Sorties : fichiers Excel/PDF rÃ©capitulatifs, tableaux KPI, graphiques, et un tableau de bord sommaire.

---

## ðŸŽ¯ 2. FonctionnalitÃ©s principales

* Extraction et nettoyage automatique des donnÃ©es brutes.
* AgrÃ©gations par pÃ©riode (semaine, mois), produit, rÃ©gion, commercial.
* Calculs KPI : CA total, CA moyen par client, marge, % de croissance vs pÃ©riode prÃ©cÃ©dente.
* GÃ©nÃ©ration automatique de graphiques (histogramme CA, courbe tendance).
* Export des rapports en **PDF** et sauvegarde des fichiers Excel.
* Planification automatique (exÃ©cution hebdomadaire / mensuelle).
* Journal d'exÃ©cution (log) et gestion d'erreurs basique.

---

## ðŸ§­ 3. Architecture du projet

**Fichiers**

* `Data_Raw.xlsx` â€” feuille avec les donnÃ©es brutes (format dÃ©fini ci-dessous).
* `Reports_Template.xlsm` â€” classeur principal contenant les macros VBA et les modÃ¨les de rapport.
* `Output/` â€” dossier de sortie pour rapports gÃ©nÃ©rÃ©s (Excel et PDF).

**Onglets requis dans `Reports_Template.xlsm`**

1. `Config` â€” paramÃ¨tres (chemins, pÃ©riode par dÃ©faut, format date, destinataires mail).
2. `RawData` â€” import (ou lien) vers `Data_Raw.xlsx` si nÃ©cessaire.
3. `KPI` â€” calculs intermÃ©diaires et indicateurs.
4. `Report_Weekly` â€” template rapport hebdo.
5. `Report_Monthly` â€” template rapport mensuel.

---

## ðŸ“¥ 4. Format des donnÃ©es brutes (colones exigÃ©es)

| Colonne      |      Type | Description                   |
| ------------ | --------: | ----------------------------- |
| Date         |      Date | Date de la vente (jj/mm/aaaa) |
| OrderID      |     Texte | Identifiant commande          |
| Client       |     Texte | Nom du client                 |
| Produit      |     Texte | DÃ©signation du produit        |
| QuantitÃ©     | NumÃ©rique | QuantitÃ© vendue               |
| PrixUnitaire | NumÃ©rique | Prix unitaire HT              |
| TVA          | NumÃ©rique | Taux de TVA (%)               |
| Cout         | NumÃ©rique | CoÃ»t unitaire                 |
| RÃ©gion       |     Texte | RÃ©gion / zone commerciale     |

> Astuce : conserver la premiÃ¨re ligne pour les en-tÃªtes et ne pas laisser de lignes vides au milieu des donnÃ©es.

---

## ðŸ› ï¸ 5. Installation et configuration rapide

1. Placez `Reports_Template.xlsm` et `Data_Raw.xlsx` dans le mÃªme dossier projet.
2. Ouvrez `Reports_Template.xlsm` et activez les macros (ruban Excel > Options > Centre de gestion de la confidentialitÃ© > Activer les macros).
3. Allez dans l'onglet `Config` et renseignez :

   * `PathOutput` : dossier `./Output`
   * `PeriodDefault` : `Weekly` ou `Monthly`
   * `DateFormat` : `dd/mm/yyyy`
   * `EmailEnabled` : `True/False` (si envoi mail activÃ©)
4. ExÃ©cutez la macro `Main_GenerateReport` (ALT+F8) pour lancer une gÃ©nÃ©ration manuelle.

---

## â–¶ï¸ 6. Utilisation â€” commandes macros (principales)

* `Main_GenerateReport(period As String)`

  * `period = "Weekly"` ou `"Monthly"`.
  * Flux : Nettoyage â†’ AgrÃ©gation â†’ Tableaux KPI â†’ Remplissage template â†’ Export PDF â†’ Log.

* `Import_RawData()` : importe et valide le fichier `Data_Raw.xlsx`.

* `Compute_KPIs(startDate As Date, endDate As Date)` : calcule les indicateurs pour la pÃ©riode.

* `Fill_ReportTemplate(period As String)` : remplit `Report_Weekly` ou `Report_Monthly`.

* `Export_ReportAsPDF(reportSheetName As String, destPath As String)` : export PDF.

* `Schedule_CreateTask(scheduleType As String)` : (optionnel) crÃ©e une tÃ¢che Windows via script si vous souhaitez automatiser.

> Chaque macro inclut des commentaires dÃ©taillÃ©s pour faciliter la maintenance.

---

## ðŸ§© 7. Exemple de snippet VBA (extrait rapide)

```vb
' Extrait : boucle d'agrÃ©gation par produit
Sub Compute_KPIs(startDate As Date, endDate As Date)
  Dim wsData As Worksheet: Set wsData = ThisWorkbook.Sheets("RawData")
  Dim dict As Object: Set dict = CreateObject("Scripting.Dictionary")
  Dim i As Long, last As Long
  last = wsData.Cells(wsData.Rows.Count, "A").End(xlUp).Row
  For i = 2 To last
    Dim d As Date: d = wsData.Cells(i, "A").Value
    If d >= startDate And d <= endDate Then
      Dim prod As String: prod = wsData.Cells(i, "D").Value
      Dim qt As Double: qt = wsData.Cells(i, "E").Value
      Dim pu As Double: pu = wsData.Cells(i, "F").Value
      If Not dict.Exists(prod) Then dict.Add prod, qt * pu Else dict(prod) = dict(prod) + qt * pu
    End If
  Next i
  ' Ecrire les rÃ©sultats dans l'onglet KPI
End Sub
```

---

## ðŸ“ˆ 8. ModÃ¨les graphiques & design recommandÃ©

* Police : Calibri / 11 pour les donnÃ©es, 14-18 pour titres.
* Palette couleurs suggÃ©rÃ©e :

  * Accent principal : `#0ea5a4` (bleu-vert)
  * Accent secondaire : `#6366f1` (violet)
  * Accent tertiaire : `#f59e0b` (orange)
* Utiliser des cartes KPI (cellules formatÃ©es) en haut du rapport : CA total, Variation %, Top 3 produits, Top 3 commerciaux.

---

## ðŸ§ª 9. Tests et validation

1. Tester avec un petit Ã©chantillon (simuler deux semaines/mois) et vÃ©rifier :

   * Totaux correspondants au tableau source
   * Graphiques reflÃ¨tent les tendances
2. Activer le log dÃ©taillÃ© (`Config!LogLevel = "DEBUG"`) pour identifier les erreurs.

---

## ðŸ” 10. Planification (Windows Task Scheduler)

* CrÃ©er un script `.vbs` simple qui ouvre le classeur et exÃ©cute `Main_GenerateReport "Weekly"`.
* Planifier la tÃ¢che : Hebdomadaire (ex. chaque lundi 06:00) ou Mensuelle (1er du mois 06:00).

Exemple `.vbs` :

```vbscript
Set xl = CreateObject("Excel.Application")
xl.Visible = False
Set wb = xl.Workbooks.Open("C:\\Path\\To\\Reports_Template.xlsm")
xl.Run "Main_GenerateReport", "Weekly"
wb.Close True
xl.Quit
```

---

## ðŸ›¡ï¸ 11. Gestion des erreurs & journalisation

* Toutes les Ã©tapes critiques loggent dans `Output/logs.txt` avec timestamp.
* En cas d'erreur, la macro envoie (si activÃ©) un email d'alerte contenant l'extrait d'erreur.

---

## ðŸ§¾ 12. Checklist avant mise en production

* [ ] Valider le format des donnÃ©es brutes
* [ ] Sauvegarder un backup du classeur template
* [ ] Tester scheduling sur environnement de test
* [ ] VÃ©rifier permissions des dossiers d'output
* [ ] Documenter les Ã©tapes d'urgence (rollback)

---

## ðŸ“Ž 13. Ressources & bonnes pratiques

* Toujours conserver l'original `Data_Raw.xlsx` et ne jamais l'Ã©craser.
* Versionner le classeur `Reports_Template.xlsm` (ex. `v1.0`, `v1.1`).
* Ajouter des tests unitaires simples (ex. macros de vÃ©rification de cohÃ©rence).

---

## ðŸ’¡ 14. Personnalisation (exemples d'amÃ©liorations)

* Envoi automatique par email des rapports (Outlook automation).
* Dashboard Power BI Ã  partir des fichiers exportÃ©s.
* Connecteur direct vers base de donnÃ©es (SQL) pour Ã©viter import manuel.

---

Â© 2025 â€” Automatisation Rapports de Ventes â€¢ ConÃ§u pour Ãªtre simple, lisible et facilement maintenable.

